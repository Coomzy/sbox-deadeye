@using Sandbox;
@using Sandbox.UI;
@using System;
@inherits PanelComponent

<root>
	<div class="container">
		<!--<div @ref=medal class="circle"></div>-->
		<img src=@GetCurrentMedalImage() style="width: 200px; height: 200px;" />
		<div class="title">@GetRemainingReactTime()</div>
	</div>
</root>

@code
{
	[Property, ImageAssetPath] public string test { get; set; }
	protected Panel medal;

	string GetRemainingReactTime()
	{
		if (GamePlayManager.instance == null)
		{
			// HACK: Just doing "" didn't seem to make the UI disappear, maybe it doesn't create a valid hash or something?
			return " ";
		}

		var levelTime = GamePlayManager.instance.levelTime;
		var formattedTime = FormatTime(levelTime);
		return formattedTime;
	}


	string GetCurrentMedalImage()
	{
		if (GamePlayManager.instance == null)
		{
			// HACK: Just doing "" didn't seem to make the UI disappear, maybe it doesn't create a valid hash or something?
			return " ";
		}

		var currentMedal = GamePlayManager.instance.currentMedal;
		var medalImage = GameSettings.instance.GetMedalImage(currentMedal);
		return medalImage;
	}

	public string FormatTime(float time)
	{
		int minutes = (int)(time / 60);
		float seconds = time % 60;

		return string.Format("{0:00}:{1:00.000}", minutes, seconds);
	}


	protected override int BuildHash() => System.HashCode.Combine(GetRemainingReactTime());
}